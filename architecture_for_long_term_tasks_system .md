# Простая архитектура для систем обработки задач занимающих длительное время

## Аннотация
В данной статье рассматривается простая архитектура подходящая для реализации систем выполняющих длительные операции по запросу клиента.  
Описанная архитектура является асинхронной и горизонтально масштабируемой.


## Введение
Среди всего многообразия задач, с которыми сталкиваются программисты при разработке корпоративных систем, можно выделить подкласс который можно определить как "создание подсистем выполнение длительных операций по запросу клиента". К такому классу задач, к примеру, можно отнести задачи построения больших отчетов, построение аналитики по сложным и/или большим выборкам, выполение преобразования данных одного формата в другой, и т.д. Все приведенные примеры объединяются по нескольким признакам: Во-первых, все эти задачи стартуют по запросу пользователя. Во-вторых, они являются длительными. И, наконец, третий признак: пользователь хочет получить уведомление о завершении операции, для дальнейшй работы с результатами ее выполнения.  
Задача построения таких подсистем усложняется, если к длительности самой операции добавляется массовость запросов на ее выполнение. Т.е. к подсистеме предъявляются требования масштабируемости не только самого процесса вычисления, но и взятия заказов в обработку. 
Очивидным решением, является асинхрооное вполнение операций. Далее, на примере подсистемы преобразования документации из html в pdf будет показана достаточно простое архитектурное решение для такой подсистемы.  

## Общее описание задачи

Любая компания, производящая выскотехнологичный продукт, будь то ПО или станки, должна вести подробную документацию на свою продукцию. Документация, и разного рода соглашения, обеспечивают, кроме прочего, юридическую защиту компании.   
Предположим, что некая компания ведет документацию в формате HTML. Это может быть удобно, если изначально стояла задача предоставить удобный и простой способ доступа к документации для клиентов.  
Для формироания, ведения и публикации документации IT отдел компании разработал внутреннюю систему. Через некоторое время, юредический отдел запросил предоставить им возможность преобразования документации из формата HTML в формат PDF. При этом, подразумивается осуществлять перевод в PDF не все  имеющуюся документацию, а лишь проивозольного ее подмножества: определенные главы/пункты/подпункты.  
Допустим, что документация довольно объемна, и зависит, как от самого продукта, так и от его версии/модификации.   

## Описание в виде User Case

**_Цель:_** Преобразование определенного подмножества документации по продукту из HTML формата в формат PDF.  
**_Акторы:_** Уполномоченный оператор юредического отдела.  
**_Интересанты_**: Ответственные сотрудники юр. отдела.    
**_Предворительные условия:_** Во внутренней системе сформированна полная документация на продукт указанной версии/модификации в формате HTML.   
**_Активаторы:_** Запрос юридического отдела на формирования определенного подмножества документации на продукт в виде PDF-файла.  
**_Порядок событий:_**  
1. Уполномоченный оператор заходит во внутреннию систему и проверяет статус формирования документации для заданного продукта версии/модификации;  
2. Если у документации стоит статус "сформирована";  
3. Оператор переходит в оглавление документации и переводит его в режим "выбора разделов для трансляции", при этом у каждого пункта оглавления появляется чекбокс, а слева от оглавления появляется кнопка "Транслировать в PDF";  
4. Проставляя галочки в чекбоксах, оператор выбирает необходимые пункты документации;  
5. По завершению выбора, оператор нажымает на кнопку "Транслировать в PDF"; 
6. Система преобразует, выбранные пользователем, разделы документации в PDF;  
7. Система оповещает заинтересованных лиц об окончании формирования PDF;
_Альтернативные сценарии опущены._
 
## Архитектура системы
